<!DOCTYPE html>
<html>

<head>
  <title>Data Migration Tool</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>

<body class="no-animations">
  <nav class="navbar">
    <div class="navbar-left">
      <a href="/" class="navbar-title" style="text-decoration:none;">Data Migration Tool</a>
    </div>
    <div class="navbar-right">
      <button type="button" id="manageConnectionsBtn" class="nav-btn">Manage Connections</button>
      <button type="button" id="manageSchedulesBtn" class="nav-btn">Manage Schedules</button>
      <button id="viewHistoryBtn" class="nav-btn" title="View Migration History">History</button>


    </div>
  </nav>
  <div class="page-content">
    <div class="form-col">
      <form id="migrateForm">
        <label>Source Connection</label>
        <div class="custom-select" id="sourceSelect">
          <button type="button" class="select-button" id="sourceButton">
            <span class="button-text">Select a connection...</span>
            <span aria-hidden="true">▼</span>
          </button>
          <div class="select-options" id="sourceOptions"></div>
          <select id="source" style="display:none;"></select>
        </div>
        
        <label>Destination Connection</label>
        <div class="custom-select" id="destSelect">
          <button type="button" class="select-button" id="destButton">
            <span class="button-text">Select a connection...</span>
            <span aria-hidden="true">▼</span>
          </button>
          <div class="select-options" id="destOptions"></div>
          <select id="destination" style="display:none;"></select>
        </div>
        <label>Source Query</label>
        <textarea id="query" rows="4"></textarea>
        <button type="button" id="previewBtn" class="btn fullwidth">Preview & Map Columns</button>
        <label>Destination Table Name</label>
        <input id="target_table" type="text" name="target_table" />
        <label>Schedule Time</label>
        <div class="time-picker-card">
          <div class="time-picker-body" id="timePickerBody">
            <input type="time" id="schedule_time" name="schedule_time" value="02:00" />
            <div class="time-quick-actions">
              <button type="button" class="time-quick-btn" id="timeNowBtn">Now</button>
              <button type="button" class="time-quick-btn" id="timePlus15Btn">+15 min</button>
              <button type="button" class="time-quick-btn" id="timePlus30Btn">+30 min</button>
            </div>
          </div>
          <div class="time-picker-footer">Runs daily at the selected time (local server time).</div>
        </div>
        <div class="btn-bar">
          <button type="submit" id="migrateBtn" class="btn btn-main">Migrate</button>
          <button type="button" id="scheduleBtn" class="btn">Schedule Migration</button>
        </div>
      </form>
      <div id="result" class="result-div"></div>
      <div id="progressArea" class="progress-ctn" style="display:none;">
        <div id="progressbar" class="progressbar">
          <div id="progressfill" class="progressfill"></div>
        </div>
        <div id="progressText" class="progress-text"></div>
      </div>
    </div>
    <!-- Side panel is hidden by default -->
    <aside class="side-panel-upg" id="sidePanel" style="display:none;">
      <section>
        <div class="side-panel-title">Column Type Mapping</div>
        <div class="side-panel-content" id="typeMapForm"></div>
      </section>
      <section>
        <div class="side-panel-title">Preview Results</div>
        <div class="side-panel-content" id="queryPreview"></div>
      </section>
    </aside>
  </div>
  
  <script src="{{ url_for('static', filename='index.js') }}"></script>
  <script>
    document.getElementById('manageConnectionsBtn').onclick = () => window.location = '/manage-connections';
    document.getElementById('manageSchedulesBtn').onclick = () => window.location = '/schedules';
    document.getElementById('viewHistoryBtn').onclick = () => window.location = '/migration-history';
  </script>
</body>

</html>